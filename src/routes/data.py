"""\nData Routes - Query stored workout data\n\nEndpoints for retrieving workout data with filtering options.\nAll times are in Pacific timezone (America/Los_Angeles).\n"""\n\nfrom fastapi import APIRouter, Query\nfrom typing import Optional\nfrom datetime import datetime\nfrom zoneinfo import ZoneInfo\n\nfrom .storage import workout_storage\n\nrouter = APIRouter()\n\nDEFAULT_TIMEZONE = "America/Los_Angeles"\n\n\n@router.get("/workouts")\nasync def get_workouts(\n    days: Optional[int] = Query(7, ge=1, le=365, description="Number of days of history"),\n    workout_type: Optional[str] = Query(None, description="Filter by workout type")\n):\n    """\n    Get all workouts from the last N days.\n    Optionally filter by workout type.\n    """\n    if workout_type:\n        workouts = workout_storage.get_by_type(workout_type)\n    else:\n        workouts = workout_storage.get_recent(days)\n    \n    return {\n        "status": "ok",\n        "workouts": workouts,\n        "count": len(workouts),\n        "days": days,\n        "filter": workout_type\n    }\n\n\n@router.get("/workouts/today")\nasync def get_todays_workouts():\n    """\n    Get today's workouts (Pacific time).\n    """\n    pacific = ZoneInfo(DEFAULT_TIMEZONE)\n    today = datetime.now(pacific).strftime("%Y-%m-%d")\n    workouts = workout_storage.get_today()\n    \n    return {\n        "status": "ok",\n        "date": today,\n        "workouts": workouts,\n        "count": len(workouts),\n        "timezone": DEFAULT_TIMEZONE\n    }\n\n\n@router.get("/workouts/date/{date}")\nasync def get_workouts_by_date(date: str):\n    """\n    Get workouts for a specific date (YYYY-MM-DD).\n    """\n    workouts = workout_storage.get_by_date(date)\n    \n    return {\n        "status": "ok",\n        "date": date,\n        "workouts": workouts,\n        "count": len(workouts)\n    }\n\n\n@router.get("/workouts/type/{workout_type}")\nasync def get_workouts_by_type(workout_type: str):\n    """\n    Get all workouts of a specific type.\n    Examples: 'Functional Training', 'Golf', 'Yoga', 'Running'\n    """\n    workouts = workout_storage.get_by_type(workout_type)\n    \n    return {\n        "status": "ok",\n        "workout_type": workout_type,\n        "workouts": workouts,\n        "count": len(workouts)\n    }\n\n\n@router.get("/workouts/summary")\nasync def get_workout_summary(\n    days: Optional[int] = Query(7, ge=1, le=365, description="Number of days for summary")\n):\n    """\n    Get workout summary for the last N days.\n    Returns total workouts, duration, calories by type.\n    """\n    summary = workout_storage.get_summary(days)\n    pacific = ZoneInfo(DEFAULT_TIMEZONE)\n    \n    return {\n        "status": "ok",\n        "summary": summary,\n        "generated_at": datetime.now(pacific).isoformat(),\n        "timezone": DEFAULT_TIMEZONE\n    }\n\n\n@router.get("/stats")\nasync def get_stats():\n    """\n    Get basic storage statistics.\n    """\n    return {\n        "status": "ok",\n        "total_workouts_stored": workout_storage.count(),\n        "storage_type": "in-memory with file persistence"\n    }\n